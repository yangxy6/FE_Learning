# 第一章 作用域

## 1.1 编译原理

JavaScript 是一门编译语言。执行前有三个步骤：

- 分词/词法分析(Tokenizing/Lexing)
  将字符串分解成代码块(token)。
  例如：`var a = 2 ;`将会被拆分为`var,a,=,2,;`。
  ![token分析](https://s2.ax1x.com/2019/08/08/eoIASO.png)

> 如果词法单元在判断 a 是一个独立的此法单元还是其他词法单元一部分时，调用的是有状态的解析规则，这个过程被称为词法分析。

- 解析/语法分析（parsing）
  **AST 抽象语法树**：将词法单元流（数组）转换为一个由元素逐级嵌套组成代表了程序语法结构的树。
  ![语法分析](https://s2.ax1x.com/2019/08/08/eoIElD.png)
- 代码生成
  将 AST 转换为可执行代码的过程叫代码生成。

对于 JavaScript 来说，大部分情况下编译发生在代码执行前几微秒的时间内。

## 1.2 理解作用域

### 编译三大部门

- 引擎
- 编译器：负责语法分析及代码生成
- 作用域：负责收集并维护所有声明的标识符（变量）组成一系列查询。确定当前执行的代码对这些标识符的访问权限。

### LHS 查询与 RHS 查询

赋值操作的左侧和右侧

- LHS：赋值操作的左侧（赋值操作的目标是谁）
- RHS：赋值操作的右侧（取到它的源头值，不一定是赋值操作），例如 console.log()
